# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id: Portfile 125355 2014-09-14 17:33:51Z khindenburg@macports.org $

PortSystem      1.0

name            argus-clients
version         3.0.6
categories      net
license         GPL-2+ BSD-old
maintainers     googlemail.com:usx303 \
                openmaintainer

homepage        http://www.qosient.com/argus/
description     Network Audit Record Generation and Utilization System
long_description\
    Argus is a real-time Flow Monitor that is designed to perform \
    comprehensive IP network traffic auditing.

platforms       darwin
depends_build   port:flex port:bison
depends_lib     path:bin/perl:perl5 \
                port:rrdtool \
                port:readline

master_sites    http://qosient.com/argus/src/ \
                ftp://qosient.com/pub/argus/src/

checksums       md5 f6289cbe33eb78818a6a7eef3b7f5662 \
                sha256 a7239007f048c5a85001ecc665c1d814422b7768c2fb45e558899370a9653c5d \
                rmd160 769230ea0b02c2de5dd873cf57dba46ecdfdaf4b

configure.cflags-append -std=gnu89
default_variants +sasl

variant no_ragraph description {Build without ragraph (no dependencies on rrdtool)} {
    depends_lib-delete port:rrdtool
}

variant sasl description {Enable SASL support} {
    depends_lib-append    port:cyrus-sasl2
    configure.args-append --with-sasl=${prefix}
}

post-destroot   {
    move "${destroot}${prefix}/argus" "${destroot}${prefix}/share/argus"
    delete "${destroot}${prefix}/bin/argusclientbug"
    if {[variant_isset no_ragraph]} {
        delete "${destroot}${prefix}/bin/ragraph"
    } else {
        reinplace "s|#! /usr/bin/perl|#! ${prefix}/bin/perl|" ${destroot}${prefix}/bin/ragraph
    }
    foreach script {radark rahosts raports} {
        reinplace "s|#! /usr/bin/perl|#! ${prefix}/bin/perl|" ${destroot}${prefix}/bin/${script}
    }
}

livecheck.url   [lindex ${master_sites} 0]
livecheck.regex argus-(\[0-9.\]+)${extract.suffix}
