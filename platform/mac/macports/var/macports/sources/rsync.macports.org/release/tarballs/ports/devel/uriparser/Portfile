# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id: Portfile 136039 2015-05-10 17:07:04Z ryandesign@macports.org $

PortSystem 1.0

name            uriparser
version         0.8.2
revision        1
categories      devel www
maintainers     ryandesign openmaintainer
license         BSD
description     a strictly RFC 3986 compliant parsing library for URIs
long_description \
    uriparser is a strictly RFC 3986 compliant parsing library for URIs.    \
    uriparser is cross-platform, fast, and supports Unicode.

homepage        http://uriparser.sourceforge.net/
platforms       darwin
master_sites    sourceforge:project/uriparser/Sources/${version}/
use_bzip2       yes

checksums       rmd160  26d71fd232093f51cdd287809ad3692abf8c720a \
                sha256  6d6e66b0615f65e9e2391933dab7e45eca0947160f10c6b47bc50feda93e508f

configure.cppflags

configure.args  --disable-doc \
                --disable-test

test.run        yes
test.target     check

# Needed by libkml's build system.
destroot.delete_la_files no

pre-activate {
    # libkml @1.2.0_1 and earlier installed a copy of liburiparser.dylib.
    if {![catch {set installed [lindex [registry_active libkml] 0]}]} {
        set _version [lindex $installed 1]
        set _revision [lindex $installed 2]
        if {[vercmp $_version 1.2.0] < 0 || ([vercmp $_version 1.2.0] == 0 && $_revision <= 1)} {
            registry_deactivate_composite libkml "" [list ports_nodepcheck 1]
        }
    }
}

livecheck.regex /${name}-(\[0-9.\]+)${extract.suffix}
