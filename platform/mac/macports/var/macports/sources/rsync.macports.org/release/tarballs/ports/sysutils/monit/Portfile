# $Id: Portfile 139229 2015-08-08 03:10:35Z jeremyhu@macports.org $

PortSystem 1.0

name                monit
version             5.12.1
categories          sysutils
platforms           darwin freebsd linux netbsd openbsd solaris
license             GPL-3
maintainers         nomaintainer

description         monit is a utility for managing and monitoring, processes, \
                    files, directories and devices on a UNIX system.
long_description    Monit can start a process if it does not run, restart a process \
                    if it does not respond and stop a process if it uses too many resources. \
                    You can use monit to monitor files, directories and devices for changes, \
                    such as timestamp changes, checksum changes or size changes. You can also \
                    monitor remote hosts\; monit can ping a remote host and can check TCP/IP \
                    port connections and server protocols. Monit is controlled via an easy \
                    to use control file based on a free-format, token-oriented syntax. Monit \
                    logs to syslog or to its own log file and notifies you about error \
                    conditions and recovery status via customizable alert.

homepage            http://mmonit.com/monit/
master_sites        ${homepage}dist/

checksums           rmd160 3c8b9f73b27dd1d0d633cc2b8a33b8fe0083937f \
                    sha256 0ed2489d31313fb9f7b6867352609c8aa416c3c19be3761142356d0a9cfa41c9

depends_build       bin:flex:flex bin:bison:bison
depends_lib         path:lib/libssl.dylib:openssl

platform freebsd {
    build.type      gnu
}

platform netbsd {
    build.type      gnu
}

platform openbsd {
    build.type      gnu
}

post-destroot {
    xinstall -d ${destroot}${prefix}/etc/monit.d
    xinstall -m 640 \
        /dev/null \
        ${destroot}${prefix}/etc/monit.d/.turd_monit

    xinstall -m 700 ${worksrcpath}/monitrc ${destroot}${prefix}/etc/monitrc
    reinplace "s|#  include /etc/monit.d/|include ${prefix}/etc/monit.d/|" \
        ${destroot}${prefix}/etc/monitrc

    xinstall -d ${destroot}${prefix}/share/doc/${name}
    xinstall -m 444 -W ${worksrcpath} CONTRIBUTORS COPYING README \
        ${destroot}${prefix}/share/doc/${name}
}

startupitem.create     yes
startupitem.executable ${prefix}/bin/monit -I -c ${prefix}/etc/monitrc

