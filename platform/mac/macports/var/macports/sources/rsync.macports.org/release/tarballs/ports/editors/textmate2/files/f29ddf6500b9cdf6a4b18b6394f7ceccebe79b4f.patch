From f29ddf6500b9cdf6a4b18b6394f7ceccebe79b4f Mon Sep 17 00:00:00 2001
From: Ronald Wampler <rdwampler@gmail.com>
Date: Sat, 19 Sep 2015 10:14:00 -0400
Subject: [PATCH] Declare new protocols when building for 10.11
Upstream-Status: Backport

These were informal protocols prior to 10.11.
---
 Applications/TextMate/src/AboutWindowController.mm          | 4 ++++
 Frameworks/HTMLOutput/src/browser/HOBrowserView.h           | 4 ++++
 Frameworks/HTMLOutput/src/browser/HOBrowserView.mm          | 4 ++++
 Frameworks/HTMLOutput/src/browser/HOWebViewDelegateHelper.h | 4 ++++
 Frameworks/OakAppKit/src/OakPasteboardChooser.mm            | 4 ++++
 Frameworks/OakFilterList/src/OakChooser.mm                  | 4 ++++
 6 files changed, 24 insertions(+)

diff --git a/Applications/TextMate/src/AboutWindowController.mm b/Applications/TextMate/src/AboutWindowController.mm
index 9e89443..0e5481c 100644
--- ./Applications/TextMate/src/AboutWindowController.mm
+++ ./Applications/TextMate/src/AboutWindowController.mm
@@ -242,7 +242,11 @@ - (void)addLicense
 
 // ============================
 
+#if !defined(MAC_OS_X_VERSION_10_11) || (MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_11)
 @interface AboutWindowController () <NSWindowDelegate, NSToolbarDelegate>
+#else
+@interface AboutWindowController () <NSWindowDelegate, NSToolbarDelegate, WebFrameLoadDelegate, WebPolicyDelegate>
+#endif
 @property (nonatomic) NSToolbar* toolbar;
 @property (nonatomic) WebView* webView;
 @property (nonatomic) NSString* selectedPage;
diff --git a/Frameworks/HTMLOutput/src/browser/HOBrowserView.h b/Frameworks/HTMLOutput/src/browser/HOBrowserView.h
index 1054683..de5419b 100644
--- ./Frameworks/HTMLOutput/src/browser/HOBrowserView.h
+++ ./Frameworks/HTMLOutput/src/browser/HOBrowserView.h
@@ -2,7 +2,11 @@
 
 @class HOStatusBar;
 
+#if !defined(MAC_OS_X_VERSION_10_11) || (MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_11)
 @interface HOBrowserView : NSView
+#else
+@interface HOBrowserView : NSView <WebFrameLoadDelegate>
+#endif
 @property (nonatomic, readonly) WebView* webView;
 @property (nonatomic, readonly) BOOL needsNewWebView;
 @property (nonatomic, readonly) HOStatusBar* statusBar;
diff --git a/Frameworks/HTMLOutput/src/browser/HOBrowserView.mm b/Frameworks/HTMLOutput/src/browser/HOBrowserView.mm
index ed3ef93..6ed0377 100644
--- ./Frameworks/HTMLOutput/src/browser/HOBrowserView.mm
+++ ./Frameworks/HTMLOutput/src/browser/HOBrowserView.mm
@@ -16,7 +16,11 @@ static void ShowLoadErrorForURL (WebFrame* frame, NSURL* url, NSError* error)
 	[frame loadHTMLString:errorMsg baseURL:[NSURL fileURLWithPath:NSTemporaryDirectory()]];
 }
 
+#if !defined(MAC_OS_X_VERSION_10_11) || (MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_11)
 @interface HOBrowserView ()
+#else
+@interface HOBrowserView () <WebPolicyDelegate, WebUIDelegate, WebResourceLoadDelegate>
+#endif
 @property (nonatomic, readwrite) WebView* webView;
 @property (nonatomic, readwrite) HOStatusBar* statusBar;
 @property (nonatomic) HOWebViewDelegateHelper* webViewDelegateHelper;
diff --git a/Frameworks/HTMLOutput/src/browser/HOWebViewDelegateHelper.h b/Frameworks/HTMLOutput/src/browser/HOWebViewDelegateHelper.h
index 6946743..16d1c43 100644
--- ./Frameworks/HTMLOutput/src/browser/HOWebViewDelegateHelper.h
+++ ./Frameworks/HTMLOutput/src/browser/HOWebViewDelegateHelper.h
@@ -2,7 +2,11 @@
 @property (nonatomic) NSString* statusText;
 @end
 
+#if !defined(MAC_OS_X_VERSION_10_11) || (MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_11)
 @interface HOWebViewDelegateHelper : NSObject
+#else
+@interface HOWebViewDelegateHelper : NSObject <WebResourceLoadDelegate, WebUIDelegate>
+#endif
 @property (nonatomic, weak) id /*<HOWebViewDelegateHelperProtocol>*/ delegate;
 @property (nonatomic) BOOL needsNewWebView;
 @end
diff --git a/Frameworks/OakAppKit/src/OakPasteboardChooser.mm b/Frameworks/OakAppKit/src/OakPasteboardChooser.mm
index 9461824..9759f1a 100644
--- ./Frameworks/OakAppKit/src/OakPasteboardChooser.mm
+++ ./Frameworks/OakAppKit/src/OakPasteboardChooser.mm
@@ -45,7 +45,11 @@ - (NSAttributedString*)displayString
 }
 @end
 
+#if !defined(MAC_OS_X_VERSION_10_11) || (MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_11)
 @interface OakPasteboardChooser () <NSWindowDelegate, NSTextFieldDelegate, NSTableViewDelegate>
+#else
+@interface OakPasteboardChooser () <NSWindowDelegate, NSTextFieldDelegate, NSTableViewDelegate, NSSearchFieldDelegate>
+#endif
 @property (nonatomic) OakPasteboard*        pasteboard;
 @property (nonatomic) NSArrayController*    arrayController;
 @property (nonatomic) NSWindow*             window;
diff --git a/Frameworks/OakFilterList/src/OakChooser.mm b/Frameworks/OakFilterList/src/OakChooser.mm
index 4deb386..cd56724 100644
--- ./Frameworks/OakFilterList/src/OakChooser.mm
+++ ./Frameworks/OakFilterList/src/OakChooser.mm
@@ -108,7 +108,11 @@ - (id)accessibilityAttributeValue:(NSString*)attribute
 	return res;
 }
 
+#if !defined(MAC_OS_X_VERSION_10_11) || (MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_11)
 @interface OakChooser () <NSWindowDelegate, NSTextFieldDelegate, NSTableViewDataSource, NSTableViewDelegate>
+#else
+@interface OakChooser () <NSWindowDelegate, NSTextFieldDelegate, NSTableViewDataSource, NSTableViewDelegate, NSSearchFieldDelegate>
+#endif
 @end
 
 static void* kFirstResponderBinding = &kFirstResponderBinding;
