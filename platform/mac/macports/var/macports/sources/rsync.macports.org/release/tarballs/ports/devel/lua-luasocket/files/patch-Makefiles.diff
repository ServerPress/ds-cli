diff -ur src/makefile.old src/makefile
--- src/makefile.old			2014-04-22 22:37:30.000000000 +0200
+++ src/makefile			2014-04-23 00:09:31.000000000 +0200
@@ -32,11 +32,11 @@
 # where lua headers are found for macosx builds
 # LUAINC_macosx:
 # /opt/local/include
-LUAINC_macosx_base?=/opt/local/include
-LUAINC_macosx?=$(LUAINC_macosx_base)/lua/$(LUAV)
+LUAINC_macosx_base?=@PREFIX@/include
+LUAINC_macosx?=$(LUAINC_macosx_base)
 # FIXME default should this default to fink or to macports?
 # What happens when more than one Lua version is installed?
-LUAPREFIX_macosx?=/opt/local
+LUAPREFIX_macosx?=@PREFIX@
 CDIR_macosx?=lib/lua/$(LUAV)
 LDIR_macosx?=share/lua/$(LUAV)
 
@@ -128,15 +128,15 @@
 # for Mac OS X
 SO_macosx=so
 O_macosx=o
-CC_macosx=gcc
+CC_macosx=@CC@
 DEF_macosx= -DLUASOCKET_$(DEBUG) -DUNIX_HAS_SUN_LEN -DLUA_$(COMPAT)_MODULE \
 	-DLUASOCKET_API='__attribute__((visibility("default")))' \
 	-DUNIX_API='__attribute__((visibility("default")))' \
 	-DMIME_API='__attribute__((visibility("default")))'
 CFLAGS_macosx= -I$(LUAINC) $(DEF) -pedantic -Wall -O2 -fno-common \
-	-fvisibility=hidden
+	-fvisibility=hidden @CFLAGS@
 LDFLAGS_macosx= -bundle -undefined dynamic_lookup -o 
-LD_macosx= export MACOSX_DEPLOYMENT_TARGET="10.3"; gcc
+LD_macosx= export MACOSX_DEPLOYMENT_TARGET="10.3"; @CC@
 SOCKET_macosx=usocket.o
 
 #------
