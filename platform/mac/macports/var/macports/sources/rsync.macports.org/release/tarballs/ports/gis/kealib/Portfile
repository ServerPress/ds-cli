# $Id: Portfile 114431 2013-12-08 09:48:42Z and.damore@macports.org $

PortSystem          1.0
PortGroup           cmake 1.0
PortGroup           bitbucket 1.0

bitbucket.setup     chchrsc kealib c6d36f3
categories          gis
version             1.4.2.20140825
revision            2
license             MIT
maintainers         vince
description         KEAlib - Implements KEA file format into HDF5 format
long_description    The KEA file format developed by the OSGEO is a GIS \
                    oriented format that supports the GDAL model and allows \
                    raster attribute tables for raster GIS operations. It is \
                    built atop HDF5.
platforms           darwin
homepage            https://bitbucket.org/chchrsc/kealib

depends_lib-append  port:gdal \
                    port:hdf5

fetch.type          hg

pre-configure {
    reinplace -E "s/(gdalplugins)/lib\\/\\1/" ${worksrcpath}/trunk/gdal/CMakeLists.txt
}

configure.dir           ${worksrcpath}/trunk
configure.args-append   -DGDAL_INCLUDE_DIR=${prefix} \
                        -DGDAL_LIB_PATH=${prefix} \
                        -DHDF5_INCLUDE_DIR=${prefix} \
                        -DHDF5_LIB_PATH=${prefix} \
                        -DCMAKE_VERBOSE_MAKEFILE=ON 

build.dir               ${worksrcpath}/trunk
use_parallel_build      no

pre-install {
    ui_msg "To be able to use KEA format in GDAL, set and export\
            (or setenv) the variable GDAL_DRIVER_PATH to \
            ${prefix}/lib/gdalplugins."
}
