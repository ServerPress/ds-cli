# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id: Portfile 139461 2015-08-17 22:59:22Z ionic@macports.org $

PortSystem              1.0
PortGroup               perl5 1.0

name                    wml
version                 2.0.11
revision                6
platforms               darwin
categories              www lang
maintainers             cfaerber.name:cfaerber \
                        openmaintainer

description             Website META Language
long_description        WML is a free and extensible Webdesigner's \
                        off-line HTML generation toolkit for Unix
license                 GPL-2

homepage                http://thewml.org/
master_sites            http://thewml.org/distrib/ \
                        ftp://thewml.org/distrib/

perl5.require_variant   yes
perl5.conflict_variants yes
perl5.branches          5.16 5.18 5.20 5.22
perl5.create_variants   ${perl5.branches}

checksums               rmd160  fead82a35d116447b860d7b1c506c6de187355e8 \
                        sha256  8e11ef19ea67ff9c4b28ff0fcacf5098881ac0c5f09ddfe3abc29f1e12be5d4a

patch.args              -p1

patchfiles              patch-configure.diff \
                        patch-Makefile.in.diff \
                        patch-wml_frontend-wml.src.diff \
                        patch-pod-encoding.diff \
                        patch-no_eperl.diff \
                        patch-no_gm4.diff \
                        patch-no_tidy.diff \
                        patch-no_txt2html.diff

depends_run             port:eperl \
                        port:m4 \
                        port:tidy

depends_lib             port:gdbm \
                        port:gettext \
                        port:libiconv \
                        port:p${perl5.major}-getopt-long \
                        port:p${perl5.major}-bit-vector \
                        port:p${perl5.major}-image-size \
                        port:p${perl5.major}-io \
                        port:p${perl5.major}-term-readkey

depends_build           port:lynx

configure.args          --with-perl="${perl5.bin}" \
                        --without-modules \
                        --with-openworld \
                        --with-cc=${configure.cc}

configure.env           CPATH=${prefix}/include LANG=C LC_ALL=C

build.args              CC=${configure.cc} CPP=${configure.cpp}

build.env               LANG=C LC_ALL=C

destroot.destdir        prefix=${destroot}${prefix} \
                        mandir=${destroot}${prefix}/share/man

test.run                yes

